<div class="dashboard-container">
  <app-loading *ngIf="isLoading"></app-loading>

  <div class="header">
    <h1>Dashboard</h1>
    <div class="upload-section">
      <input type="file" (change)="onFileSelected($event)" accept=".csv" #fileInputRef>
      <button (click)="uploadFile()" [disabled]="!selectedFile || isLoading">Upload CSV</button>
    </div>
  </div>

  <div class="search-container">
    <input type="text" placeholder="Search keywords or scraped content..." [(ngModel)]="searchTerm" (keyup.enter)="performSearch()">
    <button (click)="performSearch()">Search</button>
  </div>

  <div *ngIf="uploadMessage" class="upload-message" [ngClass]="{'success': uploadMessageType === 'success', 'error': uploadMessageType === 'error'}">{{ uploadMessage }}</div>

  <div class="keyword-list-container">
    <h2>Your Keywords ({{ totalKeywords }})</h2>
    <table class="keyword-table">
      <colgroup>
        <col style="width: 40%;">
        <col style="width: 20%;">
        <col style="width: 20%;">
        <col style="width: 20%;">
      </colgroup>
      <thead>
        <tr>
          <th>Keyword</th>
          <th>Status <span class="live-indicator"></span></th>
          <th>Uploaded At</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody @listAnimation *ngIf="keywords.length > 0">
        <tr *ngFor="let keyword of keywords">
          <td>{{ keyword.text }}</td>
          <td><span class="status-badge {{ keyword.status | lowercase }}" [@flash]="keyword.status">{{ keyword.status }}</span></td>
          <td>{{ keyword.createdAt | date:'short' }}</td>
          <td><button class="details-btn" (click)="viewDetails(keyword.id)">View Details</button></td>
        </tr>
      </tbody>
    </table>

    <div class="pagination" *ngIf="totalPages > 1">
      <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
      <ng-container *ngFor="let page of visiblePages">
        <span *ngIf="page === '...'" class="pagination-ellipsis">...</span>
        <button *ngIf="page !== '...'" (click)="goToPage(page)" [class.active]="page === currentPage">{{ page }}</button>
      </ng-container>
      <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages">Next</button>
    </div>
  </div>
</div>